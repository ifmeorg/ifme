
<%= form_for(@medication) do |f| %>
  <input name="medication[refill_reminder_attributes][id]" type="hidden" value=<%= @medication.try(:refill_reminder).try(:id) %>>
  <input name="medication[take_medication_reminder_attributes][id]" type="hidden" value=<%= @medication.try(:take_medication_reminder).try(:id) %>>
  <% common_fields = [
    {
      id: 'medication_name',
      type: 'text',
      name: 'medication[name]',
      label: t('common.name'),
      value: @medication.name || nil,
      required: true,
      info: t('categories.form.name_hint'),
      dark: true
    },
    {
      id: 'medication_strength',
      type: 'number',
      name: 'medication[strength]',
      label: t('medications.form.strength'),
      value: @medication.strength || nil,
      required: true,
      info: t('medications.form.strength_hint'),
      placeholder: t('medications.form.strength_placeholder'),
      dark: true,
    },
    {
      id: 'medication_strength_unit',
      type: 'select',
      name: 'medication[strength_unit]',
      value: @medication.strength_unit || nil,
      dark: true,
      options: [
        {
          id: 'medication_strength_unit_mg',
          label: t('medications.units.mg'),
          value: t('medications.units.mg')
        },
        {
          id: 'medication_strength_unit_ml',
          label: t('medications.units.ml'),
          value: t('medications.units.ml')
        }
      ]
    },
    {
      id: 'medication_total',
      type: 'number',
      name: 'medication[total]',
      label: t('medications.index.total'),
      value: @medication.total || nil,
      required: true,
      info: t('medications.form.total_hint'),
      placeholder: t('medications.form.total_placeholder'),
      dark: true,
    },
    {
      id: 'medication_total_unit',
      type: 'select',
      name: 'medication[total_unit]',
      dark: true,
      value: @medication.total_unit || nil,
      options: [
        {
          id: 'medication_total_unit_tablets',
          label: t('medications.units.tablets.other'),
          value: t('medications.units.tablets.other')
        },
        {
          id: 'medication_total_unit_mg',
          label: t('medications.units.mg'),
          value: t('medications.units.mg')
        },
        {
          id: 'medication_total_unit_ml',
          label: t('medications.units.ml'),
          value: t('medications.units.ml')
        }
      ]
    },
    {
      id: 'medication_dosage',
      type: 'number',
      name: 'medication[dosage]',
      label: t('medications.form.dosage'),
      value: @medication.dosage || nil,
      required: true,
      info: t('medications.form.dosage_hint'),
      placeholder: t('medications.form.dosage_placeholder'),
      dark: true,
    },
    {
      id: 'medication_dosage_unit',
      type: 'select',
      name: 'medication[dosage_unit]',
      dark: true,
      value: @medication.dosage_unit || nil,
      options: [
        {
          label: t('medications.units.tablets.other'),
          value: t('medications.units.tablets.other')
        },
        {
          label: t('medications.units.mg'),
          value: t('medications.units.mg')
        },
        {
          label: t('medications.units.ml'),
          value: t('medications.units.ml')
        }
      ]
    },
    {
      id: 'medication_refill',
      type: 'date',
      name: 'medication[refill]',
      label: t('medications.form.refill'),
      value: @medication.refill || nil,
      info: t('medications.form.refill_hint'),
      required: true,
      dark: true,
    },
    {
      id: 'medication_comments',
      type: 'textarea',
      name: 'medication[comments]',
      label: t('comment.plural'),
      value: @medication.comments || nil,
      info: t('medications.form.comments_hint'),
      dark: true,
    },
    {
      id: 'refill_reminder',
      type: 'checkbox',
      dark: true,
      label: t('medications.refill_reminder'),
      info: t('medications.form.refill_reminder_hint'),
      name: 'medication[refill_reminder_attributes][active]',
      checked: @medication.try(:refill_reminder).try(:active),
      uncheckedValue: false,
      value: true
    },
    {
      id: 'take_medication_reminder',
      type: 'checkbox',
      dark: true,
      label: t('common.daily_reminder'),
      info: t('medications.form.daily_reminder_hint'),
      name: 'medication[take_medication_reminder_attributes][active]',
      checked: @medication.try(:take_medication_reminder).try(:active),
      uncheckedValue: false,
      value: true
    }
  ] %>
  <% submit_field = {
    id: 'submit',
    type: 'submit',
    value: t('common.actions.submit'),
    dark: true
  } %>
  <% google_fields = common_fields.push({
    id: 'medication_add_to_google_cal',
    type: 'checkbox',
    dark: true,
    label: t('medications.form.add_to_google_cal'),
    info: t('medications.form.google_cal_hint'),
    name: 'medication[add_to_google_cal]',
    checked: @medication.add_to_google_cal,
    uncheckedValue: false,
    value: true
  }) %>
  <%= react_component('Form', props: {
    inputs: current_user.google_oauth2_enabled? ? google_fields.push(submit_field) : common_fields.push(submit_field)
  }) %>
<% end %>
